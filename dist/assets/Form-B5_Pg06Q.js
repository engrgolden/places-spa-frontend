import{r as b,j as a}from"./index-Ck-Mt8Ar.js";import{B as j,C as k}from"./Button-CP-ZmVZW.js";const E=(e,n,t=0)=>{let s={isValid:!1,errorText:""};switch(n){case"REQUIRED":s={isValid:typeof e=="string"&&e.trim().length>0,errorText:"must have a value"};break;case"REQUIREDFILE":s={isValid:e!=="",errorText:"must choose a file"};break;case"MAXSIZEFILE":s={isValid:typeof e!="string"&&e.size<t,errorText:"file size must be less than 500kb"};break;case"MINCHARS":s={isValid:typeof e=="string"&&e.trim().length>=t,errorText:`must contain at least ${t} characters`};break;case"MAXCHARS":s={isValid:typeof e=="string"&&e.trim().length<=t,errorText:`must contain at most ${t} characters`};break;case"MINVALUE":s={isValid:Number(e)>=t,errorText:`must be greater than ${t}`};break;case"MAXVALUE":s={isValid:Number(e)<=t,errorText:`must be less than ${t}`};break;case"EMAIL":s={isValid:typeof e=="string"&&/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e),errorText:"must be a valid email address"};break;case"NONE":s={isValid:!0,errorText:""};break;default:s={isValid:!1,errorText:""};break}return s},A=(e,n)=>{const t=n.map(i=>E(e,i.type,i.customiser&&i.customiser)).filter(i=>!i.isValid),s=!t.length,l=t.length?t.map(i=>i.errorText):[];return{isValid:s,errorMessages:l}},T=({field:e,handleInputChange:n,handleBlur:t})=>{const s=b.useRef(null),[l,i]=b.useState(""),c=r=>{if(r.target.files&&r.target.files.length===1){const o=r.target.files[0];n(e,o);const u=new FileReader;u.onload=()=>{typeof u.result=="string"?i(u.result):i("")},u.readAsDataURL(o)}},m=()=>{var r;(r=s.current)==null||r.click()};return a.jsxs("div",{className:"mt-4 mx-auto",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:""}),a.jsx("input",{className:"hidden",id:e,name:e,value:"",ref:s,type:"file",accept:".jpg,.png,.jpeg",onChange:c})]}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"w-48 h-48 border my-4",children:l&&a.jsx("img",{className:"w-full h-full object-cover",src:l,alt:"Preview"})}),a.jsx(j,{text:l?"CHANGE IMAGE":"PICK IMAGE",type:"button",onClick:m,customStyle:"text-white",onBlur:()=>t(e)})]})]},e)},I=({field:e,fieldState:n,handleInputChange:t,handleBlur:s})=>{const l=e==="image",i=n.fieldType==="textarea";return a.jsxs("div",{className:"mt-4",children:[a.jsxs("label",{htmlFor:e,className:"font-black text-lg capitalize",children:[e,":"]}),i?a.jsx("textarea",{id:e,name:e,value:typeof n.value=="string"?n.value:"",onChange:c=>t(e,c.target.value),onBlur:()=>s(e),className:"w-full p-2 border rounded bg-gray-100 focus:outline-none focus:ring-2 focus:ring-purple-700 resize-none"}):l?a.jsx(T,{field:e,fieldState:n,handleInputChange:t,handleBlur:s}):a.jsx("input",{id:e,name:e,type:n.inputType||"text",value:typeof n.value=="string"?n.value:"",onChange:c=>t(e,c.target.value),onBlur:()=>s(e),className:"w-full p-2 border rounded bg-gray-100 focus:outline-none focus:ring-2 focus:ring-purple-700"}),n.isClicked&&!n.isValid&&a.jsx("ul",{className:"text-xs text-red-500",children:n.errorMessages.map((c,m)=>a.jsx("li",{children:c},m))})]},e)},R=({initialForm:e,submitAction:n,submitText:t})=>{const[s,l]=b.useState(e),i=(r,o,u=!0)=>{const d=s[r].validators||[],{isValid:x,errorMessages:f}=A(o,d);l(g=>{const y={...g[r],value:o,isValid:x,isClicked:u,errorMessages:f},V=Object.keys(g).reduce((h,p)=>{if(p==="isValid")return h;const N=p===r?x:g[p].isValid;return h&&N},!0);return{...g,[r]:y,isValid:V}})},c=r=>{r.preventDefault();const o=Object.keys(s).reduce((u,d)=>{if(d!=="isValid"){const x=s[d].value;u[d]=x??""}return u},{});n(o)},m=r=>{const o=s[r];i(r,o.value??"")};return a.jsx("form",{onSubmit:c,className:"w-11/12 m-auto my-8",children:a.jsxs(k,{classNames:"p-4 ",children:[Object.keys(s).map(r=>{if(r==="isValid")return null;const o=s[r];return a.jsx(I,{field:r,fieldState:o,handleInputChange:i,handleBlur:m},r)}),a.jsx(j,{type:"submit",disabled:!s.isValid,customStyle:"w-fit font-bold mt-8 mx-2 text-white disabled:bg-gray-500 disabled:text-gray-600 uppercase",text:t})]})})};export{R as F};
